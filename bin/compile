#!/bin/sh
# Compile OpenSSL 1.1.1

# Install dependencies
apt-get update && apt-get install -y build-essential curl wget

# Download OpenSSL 1.1.1 source
wget https://www.openssl.org/source/openssl-1.1.1.tar.gz
tar -xvf openssl-1.1.1.tar.gz
cd openssl-1.1.1


# Clean build directories
rm -rf /app/vendor/openssl

# Configure with custom installation path
./config --prefix=/app/vendor/openssl --openssldir=/app/vendor/ssl

make depend
make
make install_sw

# After make install
/usr/local/bin/openssl version

export PATH="/app/vendor/openssl/bin:$PATH"
export LD_LIBRARY_PATH="/usr/local/lib:$LD_LIBRARY_PATH"
# Clean up
rm -rf /openssl-1.1.1

